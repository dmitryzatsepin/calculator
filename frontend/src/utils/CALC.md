# Словарь формул и логики калькулятора

## Часть 1: Технические характеристики (`calculateTechnicalSpecs`)

### Блок 1.1: Расчет размеров и количества
Этот блок вычисляет, как компоненты (модули, кабинеты) укладываются в запрошенные размеры экрана.

#### Кол-во кабинетов по горизонтали (`cabinetsX`)
- **Условие**: Только для "Кабинетного" типа экрана.
- **Формула**: Целая часть от (`[Запрошенная ширина экрана, мм] / [Ширина 1 кабинета, мм]`)
- **Код**: `Math.floor(requestedScreenWidthMm / cabinetWidthMm)`

#### Кол-во кабинетов по вертикали (`cabinetsY`)
- **Условие**: Только для "Кабинетного" типа экрана.
- **Формула**: Целая часть от (`[Запрошенная высота экрана, мм] / [Высота 1 кабинета, мм]`)
- **Код**: `Math.floor(requestedScreenHeightMm / cabinetHeightMm)`

#### Общее кол-во кабинетов (`totalCabinets`)
- **Условие**: Только для "Кабинетного" типа экрана.
- **Формула**: `[Кол-во кабинетов по горизонтали] * [Кол-во кабинетов по вертикали]`
- **Код**: `cabinetsX * cabinetsY`

#### Кол-во модулей в одном кабинете (`modulesPerCabinet`)
- **Условие**: Только для "Кабинетного" типа экрана.
- **Формула**: 
(Округление до целого([Ширина кабинета] / [Ширина модуля])) *
(Округление до целого([Высота кабинета] / [Высота модуля]))

- **Код**: `Math.round(cabinetWidthMm / moduleWidthMm) * Math.round(cabinetHeightMm / moduleHeightMm)`

#### Фактическая ширина экрана (`actualScreenWidthMm`)
- Для **Кабинетного** типа: `[Кол-во кабинетов по горизонтали] * [Ширина 1 кабинета]`
- Для **Монолитного** типа: `(Целая часть от([Запрошенная ширина] / [Ширина модуля])) * [Ширина модуля]`

#### Фактическая высота экрана (`actualScreenHeightMm`)
- Для **Кабинетного** типа: `[Кол-во кабинетов по вертикали] * [Высота 1 кабинета]`
- Для **Монолитного** типа: `(Целая часть от([Запрошенная высота] / [Высота модуля])) * [Высота модуля]`

#### Общее кол-во модулей (`totalModules`)
- Для **Кабинетного** типа: `[Общее кол-во кабинетов] * [Кол-во модулей в одном кабинете]`
- Для **Монолитного** типа: 
(Целая часть от([Запрошенная ширина] / [Ширина модуля])) *
(Целая часть от([Запрошенная высота] / [Высота модуля]))

### Блок 1.2: Расчет характеристик экрана

#### Площадь экрана (`activeAreaM2`)
- **Формула**: `([Фактическая ширина, мм] * [Фактическая высота, мм]) / 1 000 000`

#### Разрешение по ширине (`resolutionWidthPx`)
- **Формула**: 
Округление([Фактическая ширина, мм] / [Ширина модуля, мм]) *
Округление([Ширина модуля, мм] / [Шаг пикселя, мм])

#### Разрешение по высоте (`resolutionHeightPx`)
- **Формула**: 
Округление([Фактическая высота, мм] / [Высота модуля, мм]) *
Округление([Высота модуля, мм] / [Шаг пикселя, мм])

#### Среднее энергопотребление, кВт (`averagePowerConsumption`)
- **Формула**: `([Общее кол-во модулей] * [Базовая мощность модуля, Вт] / [Коэф. мощности БП]) / 1000`
- **Константы**:
- Базовая мощность модуля (улица): 45 Вт
- Базовая мощность модуля (помещение): 25 Вт
- Коэффициент мощности блока питания: 0.87

#### Макс. энергопотребление, кВт (`maxPowerConsumption`)
- **Формула**: `[Среднее энергопотребление, Вт] * [Пиковый коэффициент]`
- **Константы**:
- Пиковый коэффициент: 2.5

#### Мин. дистанция просмотра (`viewingDistanceMinM`)
- **Формула**: `[Шаг пикселя, мм] / 1000`

#### Опт. дистанция просмотра (`viewingDistanceOptimalM`)
- **Формула**: `([Шаг пикселя, мм] * 1.5) / 1000`

## Часть 2: Расчет стоимости (`calculateCosts`)

### Блок 2.1: Основные компоненты

#### Курс конвертации (`conversionRate`)
- **Формула**: `[Введенный курс доллара] * 1.02` (т.е. наценка 2%)

#### Стоимость модулей
- **Формула**: `[Общее кол-во модулей] * [Цена 1 модуля в руб.]`

#### Количество блоков питания (`psuCount`)
- **Формула**: Округление в большую сторону (`[Общее кол-во модулей] / 4`)
- **Стоимость**: `[Кол-во БП] * [Цена 1 БП в руб.]`

#### Количество приемных карт (`rcvCardCount`)
- **Формула**: 
Округление в большую сторону([Разрешение по ширине, пикс] / 256) *
Округление в большую сторону([Разрешение по высоте, пикс] / 256)
- **Стоимость**: `[Кол-во карт] * [Цена 1 карты в руб.]`

#### Стоимость кабинетов
- Для **стального кабинета**: `[Площадь экрана, м²] * [Цена за 1 м² стального кабинета]`
- Для **другого материала** (алюминий и т.д.): `[Общее кол-во кабинетов] * [Цена 1 кабинета в руб.]`

#### Стоимость магнитов
- **Формула**: `([Общее кол-во модулей] * 4) * [Цена 1 магнита в руб.]`

### Блок 2.2: ЗИП (Запасные части, инструменты и принадлежности)

#### ЗИП: Модули
- **Количество**: Максимум из `(1, Целая часть от([Общее кол-во модулей] * 0.05))` (т.е. 5%, но не меньше 1 шт.)
- **Стоимость**: `[Кол-во ЗИП модулей] * [Цена 1 модуля в руб.]`

#### ЗИП: Блоки питания
- **Количество**: Максимум из `(1, Целая часть от([Кол-во ЗИП модулей] * 0.2))` (т.е. 20% от количества модулей в ЗИП, но не меньше 1 шт.)
- **Стоимость**: `[Кол-во ЗИП БП] * [Цена 1 БП в руб.]`

#### ЗИП: Приемные карты
- **Условие**: Только если общее количество приемных карт в экране 5 или больше.
- **Количество**: Максимум из `(1, Целая часть от([Общее кол-во карт] * 0.2))` (т.е. 20% от общего кол-ва, но не меньше 1 шт.)
- **Стоимость**: `[Кол-во ЗИП карт] * [Цена 1 карты в руб.]`
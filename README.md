```markdown
# Описание проекта «LED Calculator»

## Обзор
**LED Calculator** — full-stack веб-приложение для расчета характеристик и стоимости светодиодных экранов.  
**Цель**: Инструмент для менеджеров и инженеров с возможностью:
- Конфигурации LED-экранов по индивидуальным параметрам
- Генерации технических спецификаций
- Автоматического расчета стоимости

## Ключевые возможности:
- **Гибкая конфигурация:** Подбор компонентов на основе технических требований (размер, шаг пикселя, расположение).
- **Интеллектуальный расчет:** Автоматический выбор оптимальной раскладки кабинетов (горизонтальной или вертикальной) для максимального соответствия размерам заказчика.
- **Интерактивная смета:** Генерация подробной сметы с возможностью ручной корректировки количества запасных частей (ЗИП) и стоимости дополнительных услуг с мгновенным пересчетом итоговой суммы.
- **Интеграция с CRM:** Полностью готово для встраивания в `<iframe>` в CRM-системы, такие как Битрикс24.

## Стек технологий
### Бэкенд
| Компонент       | Технологии                         |
|-----------------|------------------------------------|
| Язык            | TypeScript (Node.js)               |
| Фреймворк       | Express.js                         |
| База данных     | PostgreSQL + Prisma ORM            |
| API             | GraphQL (Apollo Server + Pothos)   |
| Аутентификация  | JWT                                |
| Запуск          | PM2 (Process Manager)              |
| Безопасность    | helmet, cors                       |

### Фронтенд
| Компонент          | Технологии                    |
|--------------------|-------------------------------|
| Язык               | TypeScript (strict Type)      |
| Фреймворк          | React (Vite)                  |
| UI-библиотека      | Mantine UI                    |
| State Management   | Context API + TanStack Query  |
| GraphQL-клиент     | graphql-request               |
| Роутинг            | react-router-dom              |

### Инфраструктура и развертывание
| Компонент    | Технологии / Платформы            |
|--------------|-----------------------------------|
| Веб-сервер   | Angie                             |
| База данных  | NeonDB (Serverless PostgreSQL)    |
| CDN и защита | Cloudflare                        |
| Структура    | pnpm Workspaces (монорепозиторий) |


```mermaid
graph TD
    subgraph "Клиент"
        A[Браузер]
    end
    subgraph "Инфраструктура"
        B[Cloudflare]
        C[Сервер Ubuntu]
    end
    subgraph "Сервер Ubuntu"
        D[Angie]
        E[Frontend build]
        F[Backend (PM2)]
    end
    subgraph "Внешние сервисы"
        G[NeonDB PostgreSQL]
    end

    A -- HTTPS --> B
    B -- HTTPS --> D
    D -- /apps/led-calculator --> E
    D -- /api/local --> F
    F -- SQL --> G
```

## Структура проекта
### Бэкенд (`/backend`)
```
backend/
├── data/                   # Локальная БД (Excel) для подготовики и экспорта данных
├── dist/                   # Скомпилированные файлы (выход TypeScript)
├── node_modules/           # Установленные npm-зависимости
├── src/
│   ├── config/             # Конфигурации приложения (env, настройки)
│   ├── TS passports/       # Типы/логика для паспортов (авторизация)
│   ├── graphql/
│   │   ├── mutations/      # GraphQL-мутации (изменяющие запросы)
│   │   ├── queries/        # GraphQL-запросы (чтение данных)
│   │   └── types/          # GraphQL-типы (схемы)
│   ├── builderts/          # Утилиты для сборки (кастомные скрипты)
│   ├── schemats/           # Генерируемые схемы (TypeScript/GraphQL)
│   ├── lib/                # Вспомогательные библиотеки/утилиты
│   ├── prisma.ts           # Инициализация Prisma Client
│   ├── middleware/         # Express-прослойки (CORS, auth, logging)
│   ├── prisma/
│   │   ├── migrations/     # Миграции БД (SQL-файлы)
│   │   └── seed/           # Скрипты для тестовых данных БД
│   ├── pathos-types.d.ts   # Глобальные типы TypeScript
│   ├── pathos-types.js     # Скомпилированные типы (если используются в JS)
│   ├── schema.prisma       # Модели и подключение БД (Prisma ORM)
│   ├── services/           # Бизнес-логика (сервисные слои)
│   ├── types/express/      # Кастомные типы для Express.js
│   └── validators/         # Валидаторы данных (Zod)
├── server.ts               # Точка входа сервера (Express/Apollo)
├── .dockerignore           # Игнорируемые файлы при Docker-сборке
├── .env                    # Переменные окружения (секреты, настройки)
├── .gitignore              # Игнорируемые файлы для Git
├── copy-engine.ts          # Скрипт для копирования движка
├── copy-prisma-client.ts   # Скрипт для копирования Prisma Client
├── Dockerfile              # Инструкции для сборки Docker-образа
├── ecosystem.config.js     # Конфиг PM2 (менеджер процессов)
├── jest.config.js          # Настройки тестов (Jest)
├── package.json            # Зависимости, скрипты и метаданные проекта
└── tsconfig.json           # Конфигурация TypeScript
```

### Фронтенд (`/frontend`)
```
frontend/
├── api/                   # API-клиенты (настройка запросов к бэкенду)
├── dist/                  # Собранная версия проекта (для деплоя)
├── node_modules/          # Установленные npm-зависимости
├── public/                # Статические файлы (не обрабатываются Vite)
│   ├── favicon.ico        # Иконка сайта
│   └── index.html         # Базовый HTML-файл (шаблон)
├── src/
│   ├── assets/            # Статические ресурсы (изображения, шрифты)
│   ├── components/        # UI-компоненты (React/Vue/Svelte)
│   ├── context/           # React-контексты (глобальное состояние)
│   ├── generated/graphql/ # Автогенерируемые типы GraphQL (Apollo/Codegen)
│   ├── graphql/           # GraphQL-запросы и мутации
│   ├── hooks/             # Кастомные React-хуки
│   ├── pages/             # Страницы приложения (роутинг)
│   ├── services/          # Бизнес-логика (работа с API)
│   ├── styles/            # Глобальные стили (CSS/SASS)
│   ├── types/             # Типы TypeScript
│   ├── utils/             # Вспомогательные утилиты
│   ├── App.css            # Стили основного компонента App
│   ├── App.tsx            # Корневой React-компонент
│   ├── index.css          # Глобальные стили
│   └── main.tsx           # Точка входа (рендер React-приложения)
├── .env.local             # Локальные переменные окружения (разработка)
├── .env.production        # Продакшен-переменные окружения
├── codegen.ts             # Конфиг GraphQL Codegen (генерация типов)
├── Dockerfile             # Инструкции для сборки Docker-образа
├── eslint.config.js       # Настройки ESLint (линтер кода)
├── index.html             # Основной HTML-файл (шаблон Vite)
├── nginx.conf             # Конфигурация Nginx для деплоя
├── package.json           # Зависимости и скрипты проекта
├── tsconfig.app.json      # Настройки TypeScript для приложения
├── tsconfig.json          # Основной конфиг TypeScript
├── tsconfig.node.json     # Настройки TS для Node.js (Vite)
├── vercel.json            # Конфиг деплоя на Vercel
├── vite.config.ts         # Настройки Vite (сборка)
├── .gitattributes         # Настройки Git (например, LF/CRLF)
├── .gitignore             # Игнорируемые файлы для Git
├── .npmrc                 # Конфиг npm (регистры, токены)
├── docker-compose.yml     # Настройки Docker Compose
├── pnpm-lock.yaml         # Лок-файл зависимостей (pnpm)
├── pnpm-workspace.yaml    # Настройки монорепозитория (если используется)
└── README.md              # Документация проекта
```

## Ключевые функции
1. **Динамический калькулятор**:
   - Расчет технических параметров (разрешение, энергопотребление)
   - Формирование спецификаций компонентов
   - Автоматический расчет стоимости

2. **Особенности реализации**:
   ```tsx
   // Пример компонента формы
   <CalculatorForm>
     <PitchSelect options={pitchOptions} />
     <DimensionInputs onChange={updateSpecs} />
   </CalculatorForm>
   ```

3. **Рабочий процесс**:
   1. Пользователь выбирает параметры
   2. Система фильтрует доступные опции
   3. GraphQL-запросы к бэкенду
   4. Расчет результатов на фронтенде

## Текущий статус
✅ **Завершено**:
- Полная реализация основной логики калькулятора.
- Настройка "боевого" (production) и локального (dev) окружения.
- Полная миграция бэкенда на ES Modules.
- Устранение всех ошибок компиляции в strict режиме TypeScript.
- Реализация интерактивной сметы и расчета доп. услуг.
- Настройка автозапуска бэкенда после перезагрузки сервера. 

## Планы развития
- [ ] Экспорт результатов в PDF
- [ ] Интеграция с CRM (Bitrix24)
- [ ] Система сохранения конфигураций
- [ ] Расширенная валидация форм

## Заключение
Проект представляет собой современное решение с:
- Типобезопасным стеком (TypeScript + GraphQL)
- Гибкой архитектурой
- Потенциалом для масштабирования

> **Для новых разработчиков**: Для запуска локального dev окружения выполните pnpm install и pnpm dev в корне проекта. Убедитесь, что в backend/.env прописан DATABASE_URL.
```